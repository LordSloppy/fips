---
fip: 47
title: Allow FIO Block Producers to update their information
status: Draft
type: Functionality
author: Eric Butz <eric@fioprotocol.io>
created: 2022-11-17
updated: 2023-01-16
---

# Abstract
This FIP proposes to extend FIO Protocol functionality to enable FIO Block Producers to use [regproducer](https://developers.fioprotocol.io/pages/api/fio-api/#options-regproducer) to update their producer information.

## Modified actions
|Contract|Action|Endpoint|Description|
|---|---|---|---|
|eosio|regproducer|/register_producer|Modifies the action to allow the updating of specific fields.|

# Motivation
Currently, [regproducer](https://developers.fioprotocol.io/pages/api/fio-api/#options-regproducer) can only be used to create new producer records. If a producer calls `regproducer` to update their information, they get an error: `Already registered as a producer.` FIO Block Producers have requested an enhancement to the protocol to allow the use of `regproducer` to update their information.

# Specification
This is an early draft of the FIP intended for discussion and detail specification has not yet been created.

## Modified actions

### Register Producer
* Register a new block producer
* Update public key, location, url for a registered block producer 

#### Contract: eosio

#### Action: *regproducer*

#### End point: /register_producer 

#### Request
|Parameter|Required|Format|Definition|
|---|---|---|---|
|fio_address|Yes|FIO Address|Valid FIO Crypto Handle|
|fio_pub_key|Yes|FIO Public Key|The producer's public key that is used for signing.|
|url|Yes|Producer URL|URL of block producer's website.|
|location|Yes|Producer Location|Location ID of where BPs servers are located.|
|actor|Yes|12 character string|Valid actor of signer|
|max_fee|Yes|Positive Int|Maximum amount of SUFs the user is willing to pay for fee. Should be preceded by [/get_fee](https://developers.fioprotocol.io/api/api-spec/reference/get-fee/get-fee) for correct value.|

#### Example
```

{
  "fio_address": "producer@bob",
  "fio_pub_key": "FIO7tHihSLJVRQ2HsiVGTXAh3RgfXQvVVPpMm8pwQtiTHQHPnY5dH",
  "url": "https://bobp.io/",
  "location": 80,
  "actor": "aftyershcu22",
  "max_fee": 10000000000
}

```

#### Processing
* Validate inputs as necessary
* If registering new producer, emplace new producer record
* If public key is different for authorized FIO Handle, require authorization of the old public key owner and the new public key owner
* On public key change, the new authorized owner and public key is updated in producers table in place of the old owner and key
* If url or location are different, update their records in the producer table for the owner 
* Calling regproducer with all of the same parameters or for a producer that has already been registered will result in an exception

#### Exception Handling

The following exception handling conditions are altered. 
If the producer is active, assert the url, public_key or location are different and can be updated.

|Error condition|Trigger|Type|fields:name|fields:value|Error message|
|---|---|---|---|---|---|
|ErrorFioNameNotReg |Producer calls regproducer and is already in producer table with is_active=1.|400|"actor"|Value sent in|"Already registered as producer"|

#### Response

# Rationale
Change is required to facilitate updating of producer records.

# Implementation
https://github.com/fioprotocol/fio.contracts/tree/feature/regproducer_update

# Backwards Compatibility
No backwards compatibility issues.

# Future considerations
None

# Discussion link
https://fioprotocol.atlassian.net/browse/BD-4075
